<!doctype html><html lang=zh-cn dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="# é—®é¢˜ Serviceå±‚æ³¨å…¥Daoæ—¶ï¼Œ Intellij æ€»ä¼šä»¥çº¢è‰²æ³¢æµªçº¿æç¤ºæˆ‘ä»¬ 1 2 @Autowired private UserDao userDao; Could not autowire. No beans of &lsquo;UserDao&rsquo; type found. Checks autowiring problems in a bean class. å°½ç®¡æˆ‘ä»¬éƒ½çŸ¥é“ Dao å±‚çš„ Bean å®é™…ä¸Šéƒ½æ˜¯æœ‰"><title>ä½¿ç”¨MyBatisæ—¶ä¸ºä»€ä¹ˆDaoå±‚ä¸éœ€è¦@Repository</title>
<link rel=canonical href=https://heeexy.com/p/mybatis-classpathmapperscanner/><link rel=stylesheet href=/scss/style.min.8e60baf4cd3fc55968717a6e39762f4d28ed7ef6007566b6c7970ad0fe907198.css><meta property='og:title' content="ä½¿ç”¨MyBatisæ—¶ä¸ºä»€ä¹ˆDaoå±‚ä¸éœ€è¦@Repository"><meta property='og:description' content="# é—®é¢˜ Serviceå±‚æ³¨å…¥Daoæ—¶ï¼Œ Intellij æ€»ä¼šä»¥çº¢è‰²æ³¢æµªçº¿æç¤ºæˆ‘ä»¬ 1 2 @Autowired private UserDao userDao; Could not autowire. No beans of &lsquo;UserDao&rsquo; type found. Checks autowiring problems in a bean class. å°½ç®¡æˆ‘ä»¬éƒ½çŸ¥é“ Dao å±‚çš„ Bean å®é™…ä¸Šéƒ½æ˜¯æœ‰"><meta property='og:url' content='https://heeexy.com/p/mybatis-classpathmapperscanner/'><meta property='og:site_name' content='è¡—ä¸Šçš„åŠ¨ç‰©å›­'><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:tag' content='java'><meta property='article:tag' content='Spring'><meta property='article:tag' content='MyBatis'><meta property='article:published_time' content='2018-04-03T17:07:46+00:00'><meta property='article:modified_time' content='2018-04-03T17:07:46+00:00'><meta name=twitter:title content="ä½¿ç”¨MyBatisæ—¶ä¸ºä»€ä¹ˆDaoå±‚ä¸éœ€è¦@Repository"><meta name=twitter:description content="# é—®é¢˜ Serviceå±‚æ³¨å…¥Daoæ—¶ï¼Œ Intellij æ€»ä¼šä»¥çº¢è‰²æ³¢æµªçº¿æç¤ºæˆ‘ä»¬ 1 2 @Autowired private UserDao userDao; Could not autowire. No beans of &lsquo;UserDao&rsquo; type found. Checks autowiring problems in a bean class. å°½ç®¡æˆ‘ä»¬éƒ½çŸ¥é“ Dao å±‚çš„ Bean å®é™…ä¸Šéƒ½æ˜¯æœ‰"></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.setItem(e,"light")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label=åˆ‡æ¢èœå•>
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=https://img.heeexy.com/avatar.jpg width=300 height=300 class=site-logo loading=lazy alt=Avatar>
</a><span class=emoji>ğŸ¥</span></figure><div class=site-meta><h1 class=site-name><a href=/>è¡—ä¸Šçš„åŠ¨ç‰©å›­</a></h1><h2 class=site-description></h2></div></header><ol class=menu id=main-menu><li><a href=/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>Home</span></a></li><li><a href=/tags><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-tag" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11 3l9 9a1.5 1.5.0 010 2l-6 6a1.5 1.5.0 01-2 0L3 11V7a4 4 0 014-4h4"/><circle cx="9" cy="9" r="2"/></svg>
<span>Tags</span></a></li><li><a href=/archives><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>Archives</span></a></li><li class=menu-bottom-section><ol class=menu></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">ç›®å½•</h2><div class=widget--toc><nav id=TableOfContents><ol><li><ol><li><a href=#1-åˆ†æé—®é¢˜>1. åˆ†æé—®é¢˜</a></li><li><a href=#2-åˆ‡å…¥æºç >2. åˆ‡å…¥æºç </a><ol><li><a href=#åˆ‡å…¥ç‚¹>åˆ‡å…¥ç‚¹</a></li><li><a href=#doscan-æ‰«æèµ„æºè½¬æ¢ä¸º-beandefinition>doScan() æ‰«æèµ„æºï¼Œè½¬æ¢ä¸º BeanDefinition</a></li><li><a href=#å¯¹-beandefinition-çš„åŠ å·¥>å¯¹ BeanDefinition çš„åŠ å·¥</a></li></ol></li></ol></li></ol></nav></div></section></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><div class=article-title-wrapper><h2 class=article-title><a href=/p/mybatis-classpathmapperscanner/>ä½¿ç”¨MyBatisæ—¶ä¸ºä»€ä¹ˆDaoå±‚ä¸éœ€è¦@Repository</a></h2></div><footer class=article-time><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>Apr 05, 2018</time></div></footer></div></header><section class=article-content><h1 id=é—®é¢˜><a href=#%e9%97%ae%e9%a2%98>#</a>
é—®é¢˜</h1><p>Serviceå±‚æ³¨å…¥Daoæ—¶ï¼Œ Intellij æ€»ä¼šä»¥çº¢è‰²æ³¢æµªçº¿æç¤ºæˆ‘ä»¬</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Autowired</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>private</span><span class=w> </span><span class=n>UserDao</span><span class=w> </span><span class=n>userDao</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>Could not autowire. No beans of &lsquo;UserDao&rsquo; type found.
Checks autowiring problems in a bean class.</p><p>å°½ç®¡æˆ‘ä»¬éƒ½çŸ¥é“ Dao å±‚çš„ Bean å®é™…ä¸Šéƒ½æ˜¯æœ‰çš„ï¼Œå¹¶ä¸”å¯ä»¥è®¾ç½®å…³é—­è¿™æ¼äººçš„æç¤ºï¼Œä½†æ˜¯æˆ‘ä»¬æœ‰æ²¡æœ‰æƒ³è¿‡ä¸ºä»€ä¹ˆ Intellij å°±æ‰¾ä¸åˆ°è¿™ä¸ª Bean å‘¢ï¼Ÿç”šè‡³æœ‰äººæœ‰è¿™ç§åšæ³•</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Repository</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>interface</span> <span class=nc>UserDao</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>æ¥é¿å…æç¤ºï¼Œä½†æ˜¯è¿™ç§åšæ³•æ­£ç¡®ä¹ˆï¼Ÿ</p><p>æ‰€ä»¥ä»Šå¤©æˆ‘ä»¬çš„ç–‘é—®å°±æ˜¯</p><ol><li>ä¸ºä»€ä¹ˆ Dao å±‚ä¸éœ€è¦åŠ  @Repository æ³¨è§£ï¼Œæºç é‡Œåˆ°åº•åšäº†ä»€ä¹ˆï¼Ÿ</li><li>åŠ äº† @Repository æ³¨è§£æœ‰ä»€ä¹ˆå½±å“ï¼Ÿ</li></ol><h1 id=ç­”æ¡ˆ><a href=#%e7%ad%94%e6%a1%88>#</a>
ç­”æ¡ˆ</h1><ol><li><p>å…³é”®åœ¨äº ClassPathMapperScanner å¯¹æŒ‡å®šåŒ…çš„æ‰«æï¼Œå¹¶ä¸”æ‰«æè¿‡ç¨‹å¯¹ Spring åŸæœ¬çš„æ‰«æ Bean çš„æ­¥éª¤ &ldquo;åŠ äº†æ–™â€ ï¼ŒSpring æœ¬èº«åªæ‰«å®ç°ç±»ï¼Œä½† MyBatis çš„æ‰«æå™¨<strong>æ‰«äº†æ¥å£</strong> ã€‚å¹¶ä¸”æ‰«å®Œæ¥å£ä¹‹åï¼Œä¸ºæ¥å£é…äº†ä¸ª <strong>BeanDefinition</strong> ,å¹¶ä¸”è¿™ä¸ª bd çš„ BeanClass æ˜¯ <strong>MapperFactoryBean</strong> ã€‚</p><blockquote><p>å¯¹äº BeanDefinition å’Œ MapperFactoryBean ä¸äº†è§£çš„åŒå­¦è¯·æŸ¥è¯¢ç›¸å…³èµ„æ–™å’Œæºç </p></blockquote></li><li><p>ä»…ä»…åªèƒ½è§£å†³ Intellij é™æ€æŸ¥æ‰¾ bean çš„é—®é¢˜ï¼Œæ²¡æœ‰å®é™…ä½œç”¨ã€‚å³ä½¿åŠ äº†æ³¨è§£ï¼Œæ¯”å¦‚@Controllerï¼Œ@Service ç­‰ç­‰ï¼Œä¹Ÿä¼šè¢« Spring çš„æ‰«æå™¨ç»™å¿½ç•¥æ‰ï¼Œå› ä¸º<strong>æ‰«æå™¨ä¼šè¿‡æ»¤æ‰æ¥å£</strong>ã€‚</p></li></ol><h1 id=æºç æ¢ç´¢><a href=#%e6%ba%90%e7%a0%81%e6%8e%a2%e7%b4%a2>#</a>
æºç æ¢ç´¢</h1><blockquote><p>ä¸‹é¢çš„æºç éƒ¨åˆ†å¦‚æœè¯»è€…æå‰æœ‰ MyBatis çš„ Bean çš„æ‰§è¡Œæµç¨‹ï¼Œå’Œ Spring çš„ BeanåŠ è½½çš„ç›¸å…³çŸ¥è¯†å°±æ›´å¥½ç†è§£ã€‚</p></blockquote><h3 id=1-åˆ†æé—®é¢˜><a href=#1-%e5%88%86%e6%9e%90%e9%97%ae%e9%a2%98>#</a>
1. åˆ†æé—®é¢˜</h3><p>å…³äºä¸ºä»€ä¹ˆä¸éœ€è¦æ³¨è§£å°±èƒ½è·å–åˆ° Dao å±‚çš„ Beanï¼Œçœ‹ä¼¼ç­”æ¡ˆå¾ˆç®€å•ï¼Œå› ä¸ºé…ç½®äº†æ‰«ææŒ‡å®šè¿™ä¸ªåŒ…é‡Œçš„ xxxDao.class å•Šï¼Œæ¯”å¦‚ä½¿ç”¨æ³¨è§£ @MapperScan(&ldquo;com.example.dao&rdquo;)ã€‚</p><p>è¿™ä¸ªç­”æ¡ˆå¤ªè¿‡è¡¨é¢ï¼Œè§‰å¾—é—®é¢˜ç®€å•åªæ˜¯å› ä¸ºå¯¹ Spring çš„ Bean ä¸ç†Ÿæ‚‰ã€‚</p><p>æˆ‘ä»¬ä½•æ—¶è§è¿‡ @Component åŠå…¶è¡ç”Ÿçš„3ä¸ªæ³¨è§£ @Controllerã€@Serviceã€@Repository <strong>åŠ åœ¨æ¥å£ä¸Šé¢</strong>çš„ï¼Ÿ</p><p>è‡ªå·±æµ‹è¯•æ–°å»ºä¸ªæ¥å£ï¼Œä¸Šé¢åŠ æ³¨è§£ï¼Œç„¶åæ‰¾ä¸ª Controller é‡Œ @Autowired æ³¨å…¥ä¸€ä¸‹ï¼Œé¡¹ç›®ç«‹é©¬ä¼šæŠ¥é”™ NoSuchBeanDefinitionException ã€‚</p><h3 id=2-åˆ‡å…¥æºç ><a href=#2-%e5%88%87%e5%85%a5%e6%ba%90%e7%a0%81>#</a>
2. åˆ‡å…¥æºç </h3><h4 id=åˆ‡å…¥ç‚¹><a href=#%e5%88%87%e5%85%a5%e7%82%b9>#</a>
åˆ‡å…¥ç‚¹</h4><p>æ—¢ç„¶ä½¿ç”¨æ³¨è§£ @MapperScan å°±å¥½ä½¿ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±ä»è¿™ä¸ªç‚¹åˆ‡å…¥æºç çœ‹ä¸€ä¸‹ï¼Œå…ˆæ‰¾å‡ºæºç ä¸­ä½•å¤„ç”¨äº†æ­¤æ³¨è§£ï¼Œéå¸¸å¹¸è¿çš„æ˜¯ï¼Œåªæœ‰ä¸€å¤„ç”¨åˆ°äº†æ­¤æ³¨è§£ ï¼šMapperScannerRegistrar.registerBeanDefinitions() ã€‚</p><p>å¹¶ä¸”ä»ç±»åå’Œæ–¹æ³•åå°±å¯ä»¥å¾ˆæ¸…æ¥šçš„çœ‹å‡ºè¿™ä¸ªç±»çš„åŠŸèƒ½æ˜¯æ‰«æ Mapper å¹¶æ³¨å†Œï¼Œæ–¹æ³•çš„åŠŸèƒ½å°±æ˜¯æ³¨å†Œ BeanDefinitions åˆ° Spring ä¸­ã€‚æ–¹æ³•çš„æºç æˆ‘å°±ä¸è´´äº†ï¼Œå¾ˆå®¹æ˜“çœ‹å‡ºæ¥æ˜¯åˆ›å»ºä¸€ä¸ªæ‰«æå™¨ <code>ClassPathMapperScanner</code> ï¼Œè®¾ç½®å¥½ä¸€ç³»åˆ—å±æ€§æ¯”å¦‚ Spring çš„æ³¨å†Œè¡¨ä¹‹åï¼Œæ‰§è¡Œ doScan() æ–¹æ³•å»æ‰«æ @MapperScan æä¾›çš„åŒ…ã€‚</p><h4 id=doscan-æ‰«æèµ„æºè½¬æ¢ä¸º-beandefinition><a href=#doscan-%e6%89%ab%e6%8f%8f%e8%b5%84%e6%ba%90%e8%bd%ac%e6%8d%a2%e4%b8%ba-beandefinition>#</a>
doScan() æ‰«æèµ„æºï¼Œè½¬æ¢ä¸º BeanDefinition</h4><p>doScan() æ–¹æ³•ä¹Ÿå¾ˆç®€å•ï¼Œå°±æ˜¯ä¸¤æ­¥ï¼š</p><ol><li>è°ƒç”¨çˆ¶ç±» ClassPathBeanDefinitionScanner çš„doScan()æ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯ Spring æ‰«æBeanDefinition çš„æ–¹æ³•ã€‚è¿‡ç¨‹ä¸æ˜¯å¾ˆé‡è¦ï¼Œæˆ‘ä»¬éœ€è¦çŸ¥é“è¿™ä¸ªæ‰«ææ–¹æ³•çš„ä¸€ä¸ªå…³é”®å°±æ˜¯</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>Set</span><span class=o>&lt;</span><span class=n>BeanDefinition</span><span class=o>&gt;</span><span class=w> </span><span class=n>candidates</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>findCandidateComponents</span><span class=p>(</span><span class=n>basePackage</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>åœ¨å…¶ä¸­å¯¹æ‰€æœ‰çš„å€™é€‰è€…ä½¿ç”¨ isCandidateComponent() æ–¹æ³•åˆ¤æ–­æ˜¯å¦ä¸ºç¬¦åˆè¦æ±‚çš„ BeanDefinitionã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=n>TypeFilter</span><span class=w> </span><span class=n>tf</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=k>this</span><span class=p>.</span><span class=na>excludeFilters</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>   </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>tf</span><span class=p>.</span><span class=na>match</span><span class=p>(</span><span class=n>metadataReader</span><span class=p>,</span><span class=w> </span><span class=k>this</span><span class=p>.</span><span class=na>metadataReaderFactory</span><span class=p>))</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=k>return</span><span class=w> </span><span class=kc>false</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>   </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=n>TypeFilter</span><span class=w> </span><span class=n>tf</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=k>this</span><span class=p>.</span><span class=na>includeFilters</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>   </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>tf</span><span class=p>.</span><span class=na>match</span><span class=p>(</span><span class=n>metadataReader</span><span class=p>,</span><span class=w> </span><span class=k>this</span><span class=p>.</span><span class=na>metadataReaderFactory</span><span class=p>))</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=k>return</span><span class=w> </span><span class=n>isConditionMatch</span><span class=p>(</span><span class=n>metadataReader</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>   </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>è¿™æœ‰ä¸¤ç»„è¿‡æ»¤å™¨æ¥è¿‡æ»¤æ‰«æåˆ°çš„èµ„æºã€‚<strong>Spring é»˜è®¤çš„è¿‡æ»¤å™¨æ˜¯æ’é™¤æ‰æŠ½è±¡ç±»/æ¥å£çš„ã€‚è€ŒMyBatis çš„æ‰«æå™¨é‡æ–°æ³¨å†Œäº†è¿‡æ»¤å™¨ï¼Œé»˜è®¤å¯¹æ¥å£æ”¾è¡Œã€‚</strong></p><blockquote><p>å…¶å®è¿˜æœ‰ä¸€äº›å…¶å®ƒçš„è¿‡æ»¤è¦æ±‚ï¼Œä½†æ˜¯ä¸å½±å“æˆ‘ä»¬æœ¬é—®é¢˜çš„æ¢ç©¶ï¼Œæ‰€ä»¥ä¸æ·±å…¥è§£è¯»äº†ã€‚</p></blockquote><p>æºç è¯»åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬å…ˆæ‰¾åˆ°äº†æœ¬æ–‡çš„ç¬¬äºŒä¸ªé—®é¢˜çš„ç­”æ¡ˆã€‚ä¹Ÿå°±æ˜¯ Spring ä¼šå¿½ç•¥æ‰æ¥å£ä¸Šé¢çš„æ³¨è§£ï¼Œä¸ä¼šæ·»åŠ å®ƒè¿›å…¥ BeanDefiniiton ,ä¹Ÿå°±éš¾æ€ªæµ‹è¯•çš„æ—¶å€™ä¼šæŠ›å‡º NoSuchBeanDefinitionException çš„å¼‚å¸¸äº†ã€‚è€Œ MyBatis åˆ™ä¼šæŠŠè¿™äº›æ¥å£æ‹‰è¿‡æ¥æ³¨å†ŒBD ã€‚</p><h4 id=å¯¹-beandefinition-çš„åŠ å·¥><a href=#%e5%af%b9-beandefinition-%e7%9a%84%e5%8a%a0%e5%b7%a5>#</a>
å¯¹ BeanDefinition çš„åŠ å·¥</h4><p>è¯»åˆ°è¿™é‡Œæˆ‘ä»¬å¯èƒ½æœ‰äº†æ›´å¤§çš„ç–‘é—®ï¼Œæ‹¿æ¥å£æ³¨å†Œ BeanDefinition ï¼Œé‚£è·å– Bean çš„æ—¶å€™å¦‚ä½•å»å®ä¾‹åŒ–è¿™ä¸ªå¯¹è±¡å•Šï¼Ÿæ¥å£å¯æ˜¯ä¸èƒ½å®ä¾‹åŒ–å‡ºå¯¹è±¡çš„å•Šï¼Œè€Œä¸”æˆ‘ä»¬ä¹Ÿæ²¡æœ‰åšå®ç°ã€‚</p><p>åŸæ¥æ˜¯ MyBatis çš„æ‰«æå™¨åœ¨è°ƒç”¨å®Œçˆ¶ç±»çš„æ‰«ææ–¹æ³•åï¼Œå¯¹ BeanDefinition è¿›è¡Œäº†åŠ å·¥ processBeanDefinitions() ã€‚å…¶ä¸­æœ€å…³é”®çš„ä¸¤è¡Œä»£ç æ˜¯</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>definition</span><span class=p>.</span><span class=na>getConstructorArgumentValues</span><span class=p>().</span><span class=na>addGenericArgumentValue</span><span class=p>(</span><span class=n>definition</span><span class=p>.</span><span class=na>getBeanClassName</span><span class=p>());</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>definition</span><span class=p>.</span><span class=na>setBeanClass</span><span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=na>mapperFactoryBean</span><span class=p>.</span><span class=na>getClass</span><span class=p>());</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>ç¬¬ä¸€è¡Œï¼Œæˆ‘ä»¬å‘ç°æŠŠè¿™ä¸ª<strong>æ¥å£çš„ç±»åå¡åˆ°äº†æ„é€ å™¨å‚æ•°ä¸­</strong>ã€‚</p><blockquote><p>å°å½©è›‹ï¼Œè¿™é‡Œå¡çš„æ˜¯ String ï¼Œè€Œæˆ‘ä»¬çš„æ„é€ å™¨å‚æ•°å…¶å®è¦çš„æ˜¯ Class ã€‚ä½†æ˜¯ Spring çš„ ConstructorResolver.autowireConstructor ä¸­ç”¨åˆ°äº† Object[] argsToUse å»åšäº†ä¸ªè½¬æ¢ ã€‚</p></blockquote><p>ç¬¬äºŒè¡Œï¼ŒbeanDefinition çš„ <strong>BeanClass è¢«è®¾ç½®æˆäº† MapperFactoryBean</strong> !</p><p>ç†Ÿæ‚‰ Spring å’Œ MyBatis çš„è¯»è€…è‚¯å®šä¸€ä¸‹å°±æ˜ç™½äº†ï¼Œå°±æ˜¯è¿™ä¸ªåœ°æ–¹è¿›è¡Œäº†"å·æ¢æ¢æŸ±&rdquo;ï¼</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Autowired</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>private</span><span class=w> </span><span class=n>UserDao</span><span class=w> </span><span class=n>userDao</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>è¿˜æ˜¯æ‹¿ UserDao ä¸ºä¾‹ï¼Œæˆ‘ä»¬å‘ Spring å®¹å™¨è¯´ &ldquo;ç»™æˆ‘æ¥ä¸ª UserDao çš„å®ä¾‹&rdquo;ï¼Œè€Œ Spring æ ¹æ®æ³¨å†Œæ—¶å€™çš„ BeanDefinition ï¼Œå»å·¥å‚( <strong>MapperFactoryBean</strong> )é‡Œé¢æ‰”äº†ä¸ª UserDao.class çš„å‚æ•°è¿›å»ï¼Œå·¥å‚çš„ getObject() æ–¹æ³•ç»™æˆ‘ä»¬è¿”å›äº†å®ƒåˆ¶é€ çš„ userDao ã€‚</p><p>å°±è¿™æ ·ï¼Œæˆ‘ä»¬æ²¡æœ‰å»å†™å®ç°ç±»ï¼Œè½»è½»æ¾æ¾æ‹¿åˆ°äº†æˆ‘ä»¬éœ€è¦çš„ userDao ã€‚</p><p>è‡³äº <strong>MapperFactoryBean</strong> é‡Œåšäº†ä»€ä¹ˆè¿”å›äº† userDao å‡ºæ¥ï¼Ÿå…¶å®å°±æ˜¯å®ƒçš„ getObject æ–¹æ³•è¿”å›çš„æ˜¯ DefaultSqlSession.getMapper(Class<t> type)æ–¹æ³•ï¼Œè¿”å›çš„æ˜¯ MapperProxy ä»£ç†çš„ç±»ï¼Œè€Œè¿™ä¸ªä»£ç†ç±»çš„ invoke æ–¹æ³•å¹¶ä¸åƒæˆ‘ä»¬å¹³æ—¶è§åˆ°çš„ä»£ç†ä¸­çš„ invoke æ–¹æ³•ä¸€æ ·è°ƒç”¨åŸå§‹ç›®æ ‡çš„ method.invoke ï¼Œè€Œæ˜¯å»æ‰¾ MapperMethod æ‰§è¡Œäº†ã€‚</p><h1 id=æ”¶è·><a href=#%e6%94%b6%e8%8e%b7>#</a>
æ”¶è·</h1><p>è¿™æ¬¡çš„æºç æ¢ç©¶ä¸‹æ¥ï¼Œæ”¶è·çš„ä¸ä»…ä»…æ˜¯äº†è§£äº† Dao å±‚ Bean çš„æ³¨å…¥ï¼Œæ›´æ˜¯ä¸²èµ·äº†æˆ‘ä»¬æœ€å¸¸ç”¨çš„ Spring å’Œ MyBatis ï¼Œæ¢å¥è¯è¯´ï¼Œæˆ‘ä»¬æ‰“é€šäº†ä» Service å±‚åˆ° Dao å±‚ã€‚</p><p>åœ¨ä»¥å¾€ Debug ä»£ç æ—¶çœ‹åˆ°çš„ MapperProxyï¼ŒMapperMethodï¼Œæˆ‘ä»¬æ¸…æ¥šäº†è¿™æ˜¯ä»ä½•è€Œæ¥ï¼Œä¹Ÿå¯¹ MyBatis ä¸­ä»£ç†çš„å·§å¦™è¿ç”¨æ›´åŠ ç†Ÿæ‚‰ã€‚</p><h1 id=å‚è€ƒæ–‡çŒ®><a href=#%e5%8f%82%e8%80%83%e6%96%87%e7%8c%ae>#</a>
å‚è€ƒæ–‡çŒ®</h1><p><a class=link href=https://blog.csdn.net/java280580332/article/details/72123890 target=_blank rel=noopener>https://blog.csdn.net/java280580332/article/details/72123890</a></p><p><a class=link href=https://blog.csdn.net/mingtian625/article/details/47684271 target=_blank rel=noopener>https://blog.csdn.net/mingtian625/article/details/47684271</a></p></section><footer class=article-footer><section class=article-tags><a href=/tags/java/>Java</a>
<a href=/tags/spring/>Spring</a>
<a href=/tags/mybatis/>MyBatis</a></section><section class=article-copyright><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>Licensed under CC BY-NC-SA 4.0</span></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>ç›¸å…³æ–‡ç« </h2><div class=related-content><div class="flex article-list--tile"><article><a href=/p/mybatis_design_patterns/><div class=article-details><h2 class=article-title>MyBatis çš„æ—¥å¿—è®¾è®¡--é€‚é…å™¨æ¨¡å¼ & å·¥å‚æ¨¡å¼</h2></div></a></article></div></div></aside><footer class=site-footer><section class=copyright>&copy;
2017 -
2024 Heeexy</section><section class=powerby>ä½¿ç”¨ <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> æ„å»º<br>ä¸»é¢˜ <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.25.0>Stack</a></b> ç”± <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a> è®¾è®¡</section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>